name: Test Workflow
on:
  workflow_dispatch:
    inputs:
      acl:
        type: string
        required: true
        default: u:someone:rwx,g:some_group:rwx,d:u:someone:rwx,d:g:some_group:rwx
jobs:
  groups:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - id: user
        run: |
          acl="${{ inputs.acl }}"
          user_regex="(?:d:)?u:([A-Za-z_]+):[rwx-]{3}"
          user_regex_groups=()

          if [[ $acl =~ $user_regex ]]; then
            user_regex_groups+=${BASH_REMATCH[0]}
            user_regex_groups+=${BASH_REMATCH[1]}
          else
            echo "No match"
          fi
          echo ${user_regex_groups[*]}

      - id: group
        run: |
          acl="${{ inputs.acl }}"
          group_regex="(?:d:)?g:([A-Za-z_]+):[rwx-]{3}"
          group_regex_groups=()

          if [[ $acl =~ $group_regex ]]; then
            group_regex_groups+=${BASH_REMATCH[0]}
            group_regex_groups+=${BASH_REMATCH[1]}
          else
            echo "No match"
          fi
          echo ${group_regex_groups[*]}
