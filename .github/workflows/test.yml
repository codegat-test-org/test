on:
  workflow_dispatch:
jobs:
  a:
    runs-on: ubuntu-latest
    steps:

    # Checkout the callers `spack.yaml`
    - uses: actions/checkout@v4
      with:
        repository: access-nri/access-om3
        ref: 3-spack-yaml-versioning

    # Checkout the `schema-repo`
    - uses: actions/checkout@v4
      with:
        repository: access-nri/schema
        path: schema


    - uses: GrantBirki/json-yaml-validate@v2.7.1
      with:
        mode: fail
        files: |
          spack.yaml
        json_schema: schema/au.org.access-nri/model/spack/environment/deployment/1-0-0.json
        yaml_as_json: true
        ajv_strict_mode: false
        use_gitignore: false
